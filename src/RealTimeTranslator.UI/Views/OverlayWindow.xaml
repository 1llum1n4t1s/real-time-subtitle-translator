<Window x:Class="RealTimeTranslator.UI.Views.OverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:RealTimeTranslator.UI.Converters"
        xmlns:controls="clr-namespace:RealTimeTranslator.UI.Controls"
        Title="Subtitle Overlay"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        WindowState="Maximized"
        ResizeMode="NoResize">
    
    <Window.Resources>
        <converters:BottomMarginPercentConverter x:Key="BottomMarginPercentConverter"/>
        <Style x:Key="SubtitleTextStyle" TargetType="controls:OutlinedTextBlock">
            <Setter Property="FontFamily" Value="{Binding FontFamily}"/>
            <Setter Property="FontSize" Value="{Binding FontSize}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="Margin" Value="20,5"/>
        </Style>
        
        <Storyboard x:Key="FadeOutAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1.0" To="0.0"
                           Duration="0:0:0.5"/>
        </Storyboard>
    </Window.Resources>
    
    <Grid>
        <!-- 字幕表示エリア（画面下部） -->
        <Border VerticalAlignment="Bottom"
                HorizontalAlignment="Center"
                Background="{Binding BackgroundBrush}"
                CornerRadius="8"
                Padding="20,10"
                MaxWidth="1200">
            <Border.Margin>
                <MultiBinding Converter="{StaticResource BottomMarginPercentConverter}">
                    <Binding Path="BottomMarginPercent"/>
                    <Binding RelativeSource="{RelativeSource AncestorType=Window}" Path="ActualHeight"/>
                </MultiBinding>
            </Border.Margin>
            <ItemsControl ItemsSource="{Binding Subtitles}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <controls:OutlinedTextBlock Text="{Binding DisplayText}"
                                                    Style="{StaticResource SubtitleTextStyle}"
                                                    Fill="{Binding TextBrush}"
                                                    Stroke="{Binding StrokeBrush}"
                                                    StrokeThickness="{Binding StrokeThickness}"
                                                    Opacity="{Binding Opacity}"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
    </Grid>
</Window>
